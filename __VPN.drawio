<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0" version="24.9.1">
  <diagram name="第 1 页" id="gAtkW7bylOQtAJeNs2VR">
    <mxGraphModel dx="1426" dy="781" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2339" pageHeight="3300" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="360" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-3" value="" style="image;html=1;image=img/lib/clip_art/computers/Server_128x128.png" parent="1" vertex="1">
          <mxGeometry x="280" y="1398.75" width="40" height="42.5" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-8" value="用户主机" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="200" y="1360" width="30" height="40" as="geometry" />
        </mxCell>
        <mxCell id="c1YNYs62HSvp9bsKqj9E-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="300" y="1200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-10" value="监听路由器" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" parent="1" vertex="1">
          <mxGeometry x="280" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-11" target="x-CzQK53TSkIjmQ8a_DJ-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-11" value="" style="image;html=1;image=img/lib/clip_art/computers/Monitor_Tower_128x128.png" parent="1" vertex="1">
          <mxGeometry x="200" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-15" value="家用路由器" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="360" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="520" y="1419.5714285714284" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-17" value="" style="image;html=1;image=img/lib/clip_art/computers/Network_128x128.png" parent="1" vertex="1">
          <mxGeometry x="440" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-19" value="互联网" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#008a00;fontColor=#ffffff;strokeColor=#005700;" parent="1" vertex="1">
          <mxGeometry x="440" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-21" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="600" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-21" value="" style="image;html=1;image=img/lib/clip_art/computers/Server_Tower_128x128.png" parent="1" vertex="1">
          <mxGeometry x="520" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-22" target="EB0lFnT8MORgTNQC6fG5-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="1210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-22" value="中间服务器" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" parent="1" vertex="1">
          <mxGeometry x="520" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-27" target="x-CzQK53TSkIjmQ8a_DJ-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="410" y="1420.2068965517242" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-27" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="360" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-29" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="680" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-29" value="" style="image;html=1;image=img/lib/clip_art/computers/Network_128x128.png" parent="1" vertex="1">
          <mxGeometry x="600" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-31" value="互联网" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#008a00;fontColor=#ffffff;strokeColor=#005700;" parent="1" vertex="1">
          <mxGeometry x="600" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-35" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="760" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-35" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="680" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-36" value="家用路由器" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="680" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-39" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="840" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-39" value="" style="image;html=1;image=img/lib/clip_art/computers/Monitor_Tower_128x128.png" parent="1" vertex="1">
          <mxGeometry x="760" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-40" target="EB0lFnT8MORgTNQC6fG5-39" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="780" y="1210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-40" value="中间设备" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" parent="1" vertex="1">
          <mxGeometry x="760" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#60a917;strokeColor=#2D7600;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-47" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="920" y="1420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-47" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="840" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-48" value="家用路由器" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="840" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-50" target="x-CzQK53TSkIjmQ8a_DJ-53" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="940" y="1772.5" as="targetPoint" />
            <Array as="points">
              <mxPoint x="940" y="1791" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-50" value="" style="image;html=1;image=img/lib/clip_art/computers/Network_128x128.png" parent="1" vertex="1">
          <mxGeometry x="920" y="1400" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-51" value="互联网" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fillColor=#008a00;fontColor=#ffffff;strokeColor=#005700;" parent="1" vertex="1">
          <mxGeometry x="920" y="1360" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-68" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-53" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="1791.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#1ba1e2;strokeColor=#006EAF;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-53" target="x-CzQK53TSkIjmQ8a_DJ-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="860" y="1840" />
              <mxPoint x="160" y="1840" />
              <mxPoint x="160" y="1420" />
            </Array>
            <mxPoint x="900" y="1830" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-53" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="840" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-54" target="x-CzQK53TSkIjmQ8a_DJ-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-54" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="680" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-76" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-55" target="x-CzQK53TSkIjmQ8a_DJ-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-55" value="" style="image;html=1;image=img/lib/clip_art/networking/Repeater_128x128.png" parent="1" vertex="1">
          <mxGeometry x="360" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-56" target="x-CzQK53TSkIjmQ8a_DJ-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-56" value="" style="image;html=1;image=img/lib/clip_art/computers/Network_128x128.png" parent="1" vertex="1">
          <mxGeometry x="440" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-72" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-57" target="x-CzQK53TSkIjmQ8a_DJ-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-57" value="" style="image;html=1;image=img/lib/clip_art/computers/Server_Tower_128x128.png" parent="1" vertex="1">
          <mxGeometry x="520" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-58" target="x-CzQK53TSkIjmQ8a_DJ-57" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-58" value="" style="image;html=1;image=img/lib/clip_art/computers/Network_128x128.png" parent="1" vertex="1">
          <mxGeometry x="600" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-62" target="x-CzQK53TSkIjmQ8a_DJ-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-62" value="" style="image;html=1;image=img/lib/clip_art/computers/Monitor_Tower_128x128.png" parent="1" vertex="1">
          <mxGeometry x="760" y="1771.25" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-63" target="x-CzQK53TSkIjmQ8a_DJ-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x-CzQK53TSkIjmQ8a_DJ-63" value="" style="image;html=1;image=img/lib/clip_art/computers/Server_128x128.png" parent="1" vertex="1">
          <mxGeometry x="280" y="1770" width="40" height="42.5" as="geometry" />
        </mxCell>
        <mxCell id="c1YNYs62HSvp9bsKqj9E-14" value="流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e6d0de;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;html=1;gradientColor=#d5739d;strokeColor=#996185;" parent="1" vertex="1">
          <mxGeometry x="200" y="990" width="200" height="210" as="geometry">
            <mxRectangle x="110" y="320" width="60" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="c1YNYs62HSvp9bsKqj9E-21" value="1.和中间服务器建立连接(TCP)" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="c1YNYs62HSvp9bsKqj9E-14" vertex="1">
          <mxGeometry y="26" width="200" height="26" as="geometry" />
        </mxCell>
        <mxCell id="c1YNYs62HSvp9bsKqj9E-20" value="2.获取用户主机发出的所有数据包(AF_XDP)" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="c1YNYs62HSvp9bsKqj9E-14" vertex="1">
          <mxGeometry y="52" width="200" height="38" as="geometry" />
        </mxCell>
        <mxCell id="c1YNYs62HSvp9bsKqj9E-15" value="3.把这些数据包原封不动的全部发送给中间服务器(TCP)" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="c1YNYs62HSvp9bsKqj9E-14" vertex="1">
          <mxGeometry y="90" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-8" value="4.将中间服务器回复的内容(原始数据包)原封不动的直接发送给用户主机" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="c1YNYs62HSvp9bsKqj9E-14" vertex="1">
          <mxGeometry y="130" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-9" value="(后期可以对原始数据包进行加密)" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="c1YNYs62HSvp9bsKqj9E-14" vertex="1">
          <mxGeometry y="180" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-4" value="流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#e6d0de;gradientColor=#d5739d;strokeColor=#996185;" parent="1" vertex="1">
          <mxGeometry x="440" y="1050" width="200" height="150" as="geometry">
            <mxRectangle x="320" y="290" width="60" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-5" value="1.等待监听路由器和中间设备对本机发起TCP连接" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-4" vertex="1">
          <mxGeometry y="30" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-6" value="2.将从监听服务器获取的内容(原始数据包)发送给中间设备" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-4" vertex="1">
          <mxGeometry y="70" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-7" value="3.将中间设备回复的内容(原始数据包)发送回到监听服务器" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-4" vertex="1">
          <mxGeometry y="110" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-11" value="流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#e6d0de;gradientColor=#d5739d;strokeColor=#996185;" parent="1" vertex="1">
          <mxGeometry x="680" y="790" width="200" height="410" as="geometry">
            <mxRectangle x="560" y="220" width="60" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-12" value="&lt;div style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;介绍:这个主机拥有两个IP和MAC地址,一个是正常的IP和MAC,而另一个是用户主机设定的IP和MAC,通过创建AF_XDP或者别的原始套接字进行转发数据包,这个数据包是用户主机的IP和MAC,原封不动的从网络的一头转发到这里,&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;然后原始套接字再把这些原始数据包原封不动的再转发给路由器,&lt;/span&gt;&lt;u style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;相当于中间设备是用户主机的代理人,用户主机说什么他就说什么&lt;/font&gt;&lt;/u&gt;&lt;/div&gt;" style="text;strokeColor=#006EAF;fillColor=#1ba1e2;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontStyle=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-11" vertex="1">
          <mxGeometry y="30" width="200" height="170" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-35" value="1.和中间服务器建立连接(TCP)" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-11" vertex="1">
          <mxGeometry y="200" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-38" value="2.打开网卡混杂模式,并创建一个原始套接字用于直接转发和监听获取IP和MAC是用户主机的数据包" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-11" vertex="1">
          <mxGeometry y="230" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-34" value="3.将从中间服务器获取的内容(原始数据包)原封不动的通过原始套接字发送出去" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-11" vertex="1">
          <mxGeometry y="280" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-39" value="4.返回的数据包通过原始套接字监听,如果IP和MAC地址是用户主机用的IP和MAC就获取,并把数据包原封不动的通过TCP再发送给中间服务器" style="text;strokeColor=#005700;fillColor=#008a00;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;fontColor=#ffffff;" parent="EB0lFnT8MORgTNQC6fG5-11" vertex="1">
          <mxGeometry y="330" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="EB0lFnT8MORgTNQC6fG5-24" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;简:用户主机说的话被中间设备录音下来放给别人听,别人说的话再被中间设备录音下来放给用户主机听,相当于用户主机直接和别人说话一样,就是有点延迟&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontStyle=1;fillStyle=auto;glass=0;shadow=0;fillColor=#1ba1e2;fontColor=#ffffff;strokeColor=#006EAF;" parent="1" vertex="1">
          <mxGeometry x="280" y="1680" width="280" height="70" as="geometry" />
        </mxCell>
        <mxCell id="EWViXd4iG7tjHIWhBLR--7" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;fillColor=#1ba1e2;strokeColor=#006EAF;exitX=1;exitY=0.5;exitDx=0;exitDy=0;width=7;endSize=10.63;endWidth=13;" parent="1" source="EB0lFnT8MORgTNQC6fG5-24" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="690" y="1600" as="sourcePoint" />
            <mxPoint x="580" y="1650" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EWViXd4iG7tjHIWhBLR--22" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fillColor=#6a00ff;strokeColor=#3700CC;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-3" target="x-CzQK53TSkIjmQ8a_DJ-39" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="670" y="1480" as="sourcePoint" />
            <mxPoint x="770" y="1480" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="1480" />
              <mxPoint x="780" y="1480" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="EWViXd4iG7tjHIWhBLR--23" value="监听路由器获取到的全部数据包都原封不动的传输给中间设备" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;fontColor=#FFFFFF;" parent="EWViXd4iG7tjHIWhBLR--22" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gwFgh9pInz6CdpoA2LhA-2" value="&lt;span style=&quot;color: rgb(255, 255, 255); background-color: rgb(24, 20, 29);&quot;&gt;监听路由器获取到的全部数据包都原封不动的传输给中间设备&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="EWViXd4iG7tjHIWhBLR--22">
          <mxGeometry x="0.0157" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EWViXd4iG7tjHIWhBLR--25" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fillColor=#1ba1e2;strokeColor=#006EAF;" parent="1" source="x-CzQK53TSkIjmQ8a_DJ-11" target="x-CzQK53TSkIjmQ8a_DJ-47" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="1640" as="sourcePoint" />
            <mxPoint x="630" y="1650" as="targetPoint" />
            <Array as="points">
              <mxPoint x="230" y="1640" />
              <mxPoint x="860" y="1640" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="EWViXd4iG7tjHIWhBLR--26" value="整个过程就是一段网络运输数据包，达到的效果就是相当于用户主机直接在中间设备这里把数据包发送给家用路由器" style="edgeLabel;resizable=0;html=1;;align=center;verticalAlign=middle;" parent="EWViXd4iG7tjHIWhBLR--25" connectable="0" vertex="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MK47nBRpxyOCvtwYz0mT-1" value="代码流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="200" y="560" width="200" height="210" as="geometry" />
        </mxCell>
        <mxCell id="vj2Zs9e24-JzKse8db9l-1" value="1.创建一个只有wifi基本功能的热点(不会处理数据包)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="MK47nBRpxyOCvtwYz0mT-1" vertex="1">
          <mxGeometry y="30" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MK47nBRpxyOCvtwYz0mT-2" value="2.和中间服务器发起TCP连接" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="MK47nBRpxyOCvtwYz0mT-1" vertex="1">
          <mxGeometry y="60" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MK47nBRpxyOCvtwYz0mT-3" value="3.使用AF_XDP绑定开启wifi功能的网卡,获取这个网卡收到的全部数据包" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="MK47nBRpxyOCvtwYz0mT-1" vertex="1">
          <mxGeometry y="90" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MK47nBRpxyOCvtwYz0mT-4" value="4.将这些数据包通过之前发起的TCP连接,全部传输到中间服务器" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="MK47nBRpxyOCvtwYz0mT-1" vertex="1">
          <mxGeometry y="120" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vj2Zs9e24-JzKse8db9l-2" value="5.把这个TCP连接返回的所有内容,通过AF_XDP发送出去(发送回到用户主机)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="MK47nBRpxyOCvtwYz0mT-1" vertex="1">
          <mxGeometry y="160" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-1" value="代码流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="560" width="200" height="190" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-2" value="1.做一个TCP服务器，等待监听路由器和中间路由器对此服务器发起连接" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="9BPUU-cUFfq8zwGGeXJm-1" vertex="1">
          <mxGeometry y="30" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-3" value="2.使用AF_XDP将一端的数据包修改IP地址后直接发送给另一端的设备,比如(监听路由器获取的TCP数据包直接发送给中间路由器,中间路由器获取的TCP数据包直接发送给监听路由器,少了内核的处理直接转发数据包)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="9BPUU-cUFfq8zwGGeXJm-1" vertex="1">
          <mxGeometry y="80" width="200" height="110" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-5" value="代码流程" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="560" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-6" value="1.对中间服务器发起TCP连接" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="9BPUU-cUFfq8zwGGeXJm-5" vertex="1">
          <mxGeometry y="30" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-7" value="2.打开网卡混杂模式,将TCP获取的内容(原始数据包)通过AF_XDP,直接发送出去" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="9BPUU-cUFfq8zwGGeXJm-5" vertex="1">
          <mxGeometry y="60" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="9BPUU-cUFfq8zwGGeXJm-8" value="3.AF_XDP监听之前发出去的原始数据包的IP,如果是这个IP就将这整个数据包通过TCP连接发送回到中间服务器" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="9BPUU-cUFfq8zwGGeXJm-5" vertex="1">
          <mxGeometry y="110" width="200" height="70" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
